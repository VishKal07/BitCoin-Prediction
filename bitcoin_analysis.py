import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime
df = pd.read_csv('bitcoin.csv')
df['Date'] = pd.to_datetime(df['Date'])
df.set_index('Date', inplace=True)
print("=== BITCOIN DATA ANALYSIS ===")
print(f"Data range: {df.index.min()} to {df.index.max()}")
print(f"Total days: {len(df)}")
print(f"Columns: {df.columns.tolist()}")
print("\nFirst 5 rows:")
print(df.head())
print("\nData types:")
print(df.dtypes)
print("\nBasic statistics:")
print(df.describe())
df['Daily_Return'] = df['Close'].pct_change() * 100
df['MA_7'] = df['Close'].rolling(window=7).mean()
df['MA_30'] = df['Close'].rolling(window=30).mean()
df['MA_90'] = df['Close'].rolling(window=90).mean()

# Calculate volatility (rolling standard deviation)
df['Volatility_30'] = df['Daily_Return'].rolling(window=30).std()
print("\n=== KEY METRICS ===")
print(f"Starting Price: ${df['Close'].iloc[0]:.2f}")
print(f"Ending Price: ${df['Close'].iloc[-1]:.2f}")
print(f"Total Return: {((df['Close'].iloc[-1] / df['Close'].iloc[0]) - 1) * 100:.2f}%")
max_price = df['Close'].max()
min_price = df['Close'].min()
max_date = df['Close'].idxmax()
min_date = df['Close'].idxmin()
print(f"Highest Price: ${max_price:.2f} on {max_date}")
print(f"Lowest Price: ${min_price:.2f} on {min_date}")
avg_daily_return = df['Daily_Return'].mean()
std_daily_return = df['Daily_Return'].std()
print(f"Average Daily Return: {avg_daily_return:.2f}%")
print(f"Daily Return Standard Deviation: {std_daily_return:.2f}%")
best_day = df['Daily_Return'].max()
worst_day = df['Daily_Return'].min()
best_date = df['Daily_Return'].idxmax()
worst_date = df['Daily_Return'].idxmin()
print(f"Best Day: {best_day:.2f}% on {best_date}")
print(f"Worst Day: {worst_day:.2f}% on {worst_date}")
df['Year'] = df.index.year
yearly_stats = df.groupby('Year').agg({
    'Close': ['first', 'last', 'max', 'min'],
    'Daily_Return': ['mean', 'std'],
    'Volume': 'mean'
}).round(2)
print("\n=== YEARLY STATISTICS ===")
print(yearly_stats)
plt.style.use('seaborn-v0_8')
fig, axes = plt.subplots(2, 2, figsize=(15, 12))

# Price chart with moving averages
axes[0,0].plot(df.index, df['Close'], label='Close Price', alpha=0.7)
axes[0,0].plot(df.index, df['MA_30'], label='30-day MA', alpha=0.8)
axes[0,0].plot(df.index, df['MA_90'], label='90-day MA', alpha=0.8)
axes[0,0].set_title('Bitcoin Price with Moving Averages')
axes[0,0].set_ylabel('Price ($)')
axes[0,0].legend()
axes[0,0].grid(True, alpha=0.3)
axes[0,1].plot(df.index, df['Daily_Return'], alpha=0.7, color='orange')
axes[0,1].set_title('Daily Returns (%)')
axes[0,1].set_ylabel('Return (%)')
axes[0,1].grid(True, alpha=0.3)
axes[1,0].plot(df.index, df['Volume'], alpha=0.7, color='green')
axes[1,0].set_title('Trading Volume')
axes[1,0].set_ylabel('Volume')
axes[1,0].grid(True, alpha=0.3)
axes[1,1].plot(df.index, df['Volatility_30'], alpha=0.7, color='red')
axes[1,1].set_title('30-day Rolling Volatility')
axes[1,1].set_ylabel('Volatility')
axes[1,1].grid(True, alpha=0.3)
plt.tight_layout()
plt.show()
correlation_data = df[['Open', 'High', 'Low', 'Close', 'Volume', 'Daily_Return']].corr()
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_data, annot=True, cmap='coolwarm', center=0,
           square=True, linewidths=0.5)
plt.title('Correlation Matrix of Bitcoin Price Metrics')
plt.tight_layout()
plt.show()
monthly_returns = df['Close'].resample('M').last().pct_change() * 100
print("\n=== MONTHLY RETURNS STATISTICS ===")
print(f"Best Month: {monthly_returns.max():.2f}%")
print(f"Worst Month: {monthly_returns.min():.2f}%")
print(f"Average Monthly Return: {monthly_returns.mean():.2f}%")
positive_days = (df['Daily_Return'] > 0).sum()
negative_days = (df['Daily_Return'] < 0).sum()
neutral_days = (df['Daily_Return'] == 0).sum()
print(f"\n=== DAY DISTRIBUTION ===")
print(f"Positive days: {positive_days} ({positive_days/len(df)*100:.1f}%)")
print(f"Negative days: {negative_days} ({negative_days/len(df)*100:.1f}%)")
print(f"Neutral days: {neutral_days} ({neutral_days/len(df)*100:.1f}%)")
recent_data = df.tail(30)
recent_return = ((recent_data['Close'].iloc[-1] / recent_data['Close'].iloc[0]) - 1) * 100
print(f"\n=== RECENT PERFORMANCE (Last 30 days) ===")
print(f"Return: {recent_return:.2f}%")
print(f"Average Daily Volume: {recent_data['Volume'].mean():.0f}")
df.to_csv('bitcoin_processed.csv')
print(f"\nProcessed data saved to 'bitcoin_processed.csv'")
